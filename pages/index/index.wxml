<!--index.wxml-->
<wxs module="cart">
var cartQuantity = function(id, cartItems) {
  var quantity = 0
  var foundItem = cartItems.filter(function (item) {
    return item.id === id
  })
  if (foundItem.length) quantity = foundItem[0].quantity
  return quantity
}
module.exports = {
  cartQuantity: cartQuantity
}
</wxs>

<view class="page">
  <view class="weui-panel weui-panel_access">
    <view class="weui-panel__hd">Hot Products</view>
    <view class="weui-panel__bd">
      <block
        wx:for="{{products}}"
        wx:key="id"
        wx:for-item="product"
      >
        <view
          class="weui-media-box weui-media-box_appmsg"
        >
          <view class="weui-media-box__hd weui-media-box__hd_in-appmsg">
            <image
              class="weui-media-box__thumb"
              src="{{product.img_url}}"
            />
          </view>
          <view class="weui-media-box__bd weui-media-box__bd_in-appmsg">
            <view class="weui-media-box__title">{{ product.name_en }}</view>
            <view class="description-wrapper">
              <view class="product-price">{{ product.price }} RMB</view>
              <ItemQuantity
                productId="{{product.id}}"
                cartItems="{{cartItems}}"
              />
            </view>
          </view>
        </view>
      </block>
    </view>
  </view>
</view>